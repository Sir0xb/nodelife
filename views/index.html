{% extends "layout/layout.html" %}

{% block title %} {{ title }} {% endblock %}

{% block content %}
    <!-- ko module: container --><!-- /ko -->
{% endblock %}

{% block script %}
    <script type="text/javascript">
        var params = { test: true };
        var modules = {};
    </script>
    <script type="text/javascript">
        require(["knockout", "Super", "Tools", "ko-amd"], function (ko, Super, Tools) {
            // 问了能更灵活管理，加入插件等元素，不单独管理模块与模板，统一设置成统一目录
            ko.bindingHandlers.module.baseDir = "scripts/";  // 模块的默认文件夹
            ko.amdTemplateEngine.defaultPath = "scripts/";   // 模板的默认文件夹

            ko.amdTemplateEngine.defaultSuffix = '.html';    // 默认模板后缀

            params.mapping           = modules;
            params.mapping.getJS     = Tools.getFunc("applications", "{{ appName }}", "js", params.test);
            params.mapping.getTemp   = Tools.getFunc("applications", "{{ appName }}", "html", params.test);

            var self = Super.call(this, { parent: {}, data: params });

            self.container({
                name       : self.data.mapping.getJS("main"),
                template   : self.data.mapping.getTemp("main"),
                data       : {
                    parent: self,
                    data: self.data
                },
                afterRender: function (){
                    ko.utils.triggerEvent(document.body, "pageReady");
                }
            });

            // ko.components.register('component-name', {
            //    viewModel: {...},    //function code
            //    template: {....)	//function code
            // });

            ko.applyBindings(self);
        });
    </script>
{% endblock %}
